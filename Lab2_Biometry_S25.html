<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jennifer Bradley">
<meta name="dcterms.date" content="2025-02-11">

<title>Lab 2: Probability Distributions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Lab2_Biometry_S25_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lab2_Biometry_S25_files/libs/quarto-html/quarto.js"></script>
<script src="Lab2_Biometry_S25_files/libs/quarto-html/popper.min.js"></script>
<script src="Lab2_Biometry_S25_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Lab2_Biometry_S25_files/libs/quarto-html/anchor.min.js"></script>
<link href="Lab2_Biometry_S25_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lab2_Biometry_S25_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Lab2_Biometry_S25_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Lab2_Biometry_S25_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Lab2_Biometry_S25_files/libs/bootstrap/bootstrap-8a79a254b8e706d3c925cde0a310d4f0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 2: Probability Distributions</h1>
<p class="subtitle lead">Graded Out of 35 Points</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jennifer Bradley </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 11, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>We will again be using our Palmer Penguins data today for some problems, so let’s load that package in now:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="working-with-probability-distributions" class="level2">
<h2 class="anchored" data-anchor-id="working-with-probability-distributions">1. Working With Probability Distributions</h2>
<section id="problem-1.1-5-points" class="level3">
<h3 class="anchored" data-anchor-id="problem-1.1-5-points">Problem 1.1 (5 Points)</h3>
<p>Let <span class="math inline">\(X\)</span> be a discrete random variable whose PDF is described in the table given here:</p>
<table class="caption-top table">
<caption>PDF of a discrete random variable, X</caption>
<thead>
<tr class="header">
<th><span class="math inline">\(X\)</span></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(f(X)\)</span></td>
<td>3/8</td>
<td>1/8</td>
<td>1/8</td>
<td>3/8</td>
</tr>
</tbody>
</table>
<p>Do the following (show work, 1 point each):</p>
<ol type="A">
<li><p>Calculate <span class="math inline">\(E[X]\)</span></p>
<p><span class="math inline">\(\sum_{Sx} xp(x)\)</span></p>
<p><span class="math inline">\((1\cdot\frac{3}{8}) + (2\cdot\frac{1}{8})+(3\cdot\frac{1}{8})+(4\cdot\frac{3}{8})\)</span></p>
<p><span class="math display">\[\boxed{2.5}\]</span></p></li>
<li><p>Calculate <span class="math inline">\(Var(X)\)</span></p>
<p><span class="math inline">\(\sum_{Sx} x^2p(x)-(\sum_{Sx} xp(x))^2\)</span></p>
<p><span class="math inline">\(((1^2\cdot\frac{3}{8}) + (22\cdot\frac{1}{8})+(32\cdot\frac{1}{8})+(42\cdot\frac{3}{8}))-2.52\)</span></p>
<p><span class="math display">\[
\boxed{1.75}
\]</span></p></li>
<li><p>Plot <span class="math inline">\(f(x)\)</span>. To make a barplot, use the <code>barplot</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">8</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>,<span class="dv">3</span><span class="sc">/</span><span class="dv">8</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># realized I do not need this: prob1C.table &lt;- data.frame(fx,X)</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(fx, <span class="at">xlab=</span><span class="st">"X"</span>, <span class="at">ylab=</span><span class="st">"f(x)"</span>, <span class="at">names.arg =</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab2_Biometry_S25_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Plot <span class="math inline">\(F(x)\)</span>. To make a barplot, use the <code>barplot</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Fx <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">8</span>,((<span class="dv">3</span><span class="sc">/</span><span class="dv">8</span>)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>)),((<span class="dv">3</span><span class="sc">/</span><span class="dv">8</span>)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>)),((<span class="dv">3</span><span class="sc">/</span><span class="dv">8</span>)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>)<span class="sc">+</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">8</span>)))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># realized I do not need this: prob1D.table &lt;- data.frame(Fx,X)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(Fx, <span class="at">xlab =</span> <span class="st">"X"</span>, <span class="at">ylab =</span> <span class="st">"f(x)"</span>, <span class="at">names.arg =</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab2_Biometry_S25_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Calculate <span class="math inline">\(P(X \geq 4)\)</span></p>
<p><span class="math inline">\(\text{4 is the only possible outcome $\le$ 4 in the set}\)</span></p>
<p><span class="math inline">\(P(4) = \frac{3}{8}\)</span></p>
<p><span class="math display">\[
\boxed{\frac{3}{8}}
\]</span></p></li>
</ol>
</section>
<section id="problem-1.2-5-points" class="level3">
<h3 class="anchored" data-anchor-id="problem-1.2-5-points">Problem 1.2 (5 Points)</h3>
<p><strong>Some background:</strong> The exponential distribution is the continuous analog of the geometric distribution, which is discrete. Consider a geometric random variable <span class="math inline">\(X\)</span> with parameter prob=0.5 and an exponential random variable <span class="math inline">\(Y\)</span> with parameter rate=0.5. Note that R has a standard naming scheme for functions in which PDFs are named “d” + (distribution suffix) and CDFs are named “p” + (distribution suffix). The distribution suffix for the geometric distribution is <code>geom</code> (<em>e.g.</em>, <code>dbiom</code>), and for the exponential is <code>exp</code> (<em>e.g</em>. <code>dexp</code>). There is a trick in this question; think carefully!</p>
<ol type="A">
<li>(2 Points) Plot the PDF for <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> across a range from 0 to 10. One plot should be a barplot and the other a scatter plot with lines; part of the question is figuring out which variable matches which style of plot. Some tips:
<ul>
<li>To generate a vector of evenly spaced values over a set interval, try the <code>seq</code> function.</li>
<li>If if <code>v</code> is a vector with the values you want to evaluate between 0 and 10, then you can generate a vector with all the corresponding probabilities via <code>dgeom(x=v, prob=0.5)</code> and analogously for the exponential.</li>
<li>To make a line plot, use the <code>plot</code> function with the option <code>type="l"</code></li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>support0_10 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>XPDF <span class="ot">&lt;-</span> <span class="cf">function</span>(x,p){</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  ((<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">^</span>x)<span class="sc">*</span>p</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">XPDF</span>(support0_10,<span class="fl">0.5</span>), <span class="at">ylab =</span> <span class="st">"probability density"</span>, <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">main =</span> <span class="st">"PDF for X"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab2_Biometry_S25_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>YPDF <span class="ot">&lt;-</span> <span class="cf">function</span>(y,l){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  l<span class="sc">*</span>(<span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">^</span>(<span class="sc">-</span>l<span class="sc">*</span>y))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">YPDF</span>(support0_10,<span class="fl">0.5</span>), <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylab =</span> <span class="st">"probability density"</span>, <span class="at">xlab =</span> <span class="st">"y"</span>, <span class="at">main =</span> <span class="st">"PDF for Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab2_Biometry_S25_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol type="A">
<li>(2 Points) Calculate the probability that <span class="math inline">\(X=5\)</span> and the probability that <span class="math inline">\(Y=5\)</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">XPDF</span>(<span class="dv">5</span>,<span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.015625</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution to 1.2B
</div>
</div>
<div class="callout-body-container callout-body">
<p>P(X = 5) = 0.015625</p>
<p>P(Y = 5) = 0, because the probability that a random variable equals an exact number over a continuous interval is equal to 0</p>
</div>
</div>
<ol type="A">
<li>(1 Points) Calculate the probability that <span class="math inline">\(5&lt;X \leq 6\)</span> and the probability that that <span class="math inline">\(5 &lt; Y \leq 6\)</span>. Hint: Use the CDF for this.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pgeom</span>(support0_10[<span class="dv">7</span>], <span class="at">prob=</span><span class="fl">0.5</span>) <span class="sc">-</span> <span class="fu">pgeom</span>(support0_10[<span class="dv">6</span>], <span class="at">prob=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0078125</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pexp</span>(support0_10[<span class="dv">7</span>], <span class="at">rate=</span><span class="fl">0.5</span>) <span class="sc">-</span> <span class="fu">pexp</span>(support0_10[<span class="dv">6</span>], <span class="at">rate=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03229793</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution to 1.2C
</div>
</div>
<div class="callout-body-container callout-body">
<p>$ P(5&lt;X) = $</p>
<p>$ P(5&lt;Y)= $</p>
</div>
</div>
</section>
</section>
<section id="knowing-your-distributions" class="level2">
<h2 class="anchored" data-anchor-id="knowing-your-distributions">2. Knowing Your Distributions</h2>
<section id="problem-2.1-5-points" class="level3">
<h3 class="anchored" data-anchor-id="problem-2.1-5-points">Problem 2.1 (5 Points)</h3>
<p>For each of the following situations, propose a probability distribution that would suit the situation and justify your selection (1 point each).</p>
<ol type="A">
<li><p>We are interested in simulating the number of aphids per leaf on a tomato plant. For each leaf, there will be a discrete number of aphids, with no strict upper limit.</p>
<ol type="A">
<li><p>Poisson</p>
<ol type="A">
<li><p>Number of aphids –&gt; discrete</p></li>
<li><p>Fixed interval of space (per leaf) –&gt; Poisson</p></li>
</ol></li>
</ol></li>
<li><p>We are interested in simulating the time it takes a vulture to locate it’s next meal. Assume most vultures find a meal rather quickly, but some will take a very (arbitrarily) long time.</p>
<ol type="A">
<li><p>Exponential</p>
<ol type="A">
<li><p>Time –&gt; continuous</p></li>
<li><p>Amount of time it takes before a “success” (ie. meal located) –&gt; Exponential</p></li>
</ol></li>
</ol></li>
<li><p>We have collected 100 moths from the environment that may belong to one of two different color morphs (light and dark). We are interested in simulating the number of light moths collected in this sample.</p>
<ol type="A">
<li><p>Binomial</p>
<ol type="A">
<li><p>Two discrete categories</p></li>
<li><p>Counting the number of one of two binary options –&gt; Binomial</p></li>
</ol></li>
</ol></li>
<li><p>We are in the field, again sampling a species of moth that may belong to one of two color morphs (light or dark). We are interested in simulating whether or not an individual moth sampled will be from the dark color morph.</p>
<ol type="A">
<li><p>Bernoulli</p>
<ol type="A">
<li><p>Two discrete options</p></li>
<li><p>Counting one outcome out of two binary possibilities –&gt; Bernoulli</p></li>
</ol></li>
</ol></li>
<li><p>We are interested in simulating the average number of leaves per tree in a forest across many different forests in the Northeast US.</p>
<ol type="A">
<li><p>Normal</p>
<ol type="A">
<li><p>Average number of leaves –&gt; continuous</p></li>
<li><p>Distribution of characteristic with additive effects –&gt; Normal</p></li>
</ol></li>
</ol></li>
</ol>
</section>
<section id="problem-2.2-10-points" class="level3">
<h3 class="anchored" data-anchor-id="problem-2.2-10-points">Problem 2.2 (10 Points)</h3>
<p>For each of the following, if necessary identify the probability distribution you are using and justify your choice, then answer the question showing your work.</p>
<ol type="A">
<li><p>(2 Points) What is the probability that a predator will capture it’s first prey item after six failed attempts given that it’s probability of capturing prey per attempt is 0.3?</p>
<p>$ (1-p)^xp $</p>
<p>$ P( (1-0.3)^{6} $</p>
<p>$ = $</p></li>
<li><p>(2 Points) If new members of a species immigrate into a defined patch of habitat at a constant rate of 0.5 per day, what is the expected wait time until the next new arrival?</p>
<p>$ = }$</p>
<p>$ = $</p></li>
<li><p>(2 Points) For the example above (B), what is the expected number of arrivals over a one-week period?</p>
<p>Poisson</p>
<p>$0.5\cdot7\text{ days}=\boxed{3.5}$</p></li>
<li><p>(3 Points) We randomly selected 100 White Ash trees from a forest in upstate NY. For the area we are interested in, we know that from previous surveys about 30% of trees are infested by Emerald Ash Borers (assume a 0.3 probability that any given tree is infested). Use R to plot the pdf of the number of infested trees in your sample. Discuss (briefly!) the limitations of our approach for modeling this probability - how might the assumptions of our model be violated?</p>
<p>This approach assumes that cases of infection are independent. However, in a real-world case it is possible that trees can spread disease to one another (ie. the infection of one tree leads directly to the infection of a tree in its proximity).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>whiteashtrees <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">dbinom</span>(whiteashtrees, <span class="dv">100</span>, <span class="fl">0.3</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">3</span>), <span class="at">ylab =</span> <span class="st">"Probability of Infection"</span>, <span class="at">xlab =</span> <span class="st">"Sample"</span>, <span class="at">main =</span> <span class="st">"PDF of 100 White Ash Trees with Parameter p = 0.3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab2_Biometry_S25_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>(1 Point) We are studying a forest where tree heights are normally distributed with a mean height of 10 meters and a variance of 4 meters. What percent of trees do we expect to fall within a height range of 6-14 meters?</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
2.2E
</div>
</div>
<div class="callout-body-container callout-body">
<p>95% of samples in a normal distribution are within +- 2 standard deviations from the mean. Therefore, 95% of trees would be between 6 and 14 meters (10 +- 4 meters).</p>
</div>
</div></li>
</ol>
</section>
</section>
<section id="checking-for-normality-with-quantile-quantile-plots" class="level2">
<h2 class="anchored" data-anchor-id="checking-for-normality-with-quantile-quantile-plots">3. Checking for Normality with Quantile-Quantile Plots</h2>
<section id="problem-3.1-5-points" class="level3">
<h3 class="anchored" data-anchor-id="problem-3.1-5-points">Problem 3.1 (5 Points)</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
3.1
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Q-Q plot does not fit the trendline very well (especially at small and large values), which does not support that the data is exactly normally distributed.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>lnormal_qqplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, x){</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">log</span>(data)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqnorm</span>(ldata, <span class="at">main =</span> x)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqline</span>(ldata)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lnormal_qqplot</span>(<span class="at">data =</span> penguins<span class="sc">$</span>body_mass_g, <span class="st">"Q-Q Body Mass"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab2_Biometry_S25_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="problem-3.2-5-points" class="level3">
<h3 class="anchored" data-anchor-id="problem-3.2-5-points">Problem 3.2 (5 Points)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>a_penguins <span class="ot">&lt;-</span> <span class="fu">subset</span>(penguins, penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Adelie"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>cs_penguins <span class="ot">&lt;-</span> <span class="fu">subset</span>(penguins, penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Chinstrap"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>g_penguins <span class="ot">&lt;-</span> <span class="fu">subset</span>(penguins, penguins<span class="sc">$</span>species<span class="sc">==</span><span class="st">"Gentoo"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lnormal_qqplot</span>(a_penguins<span class="sc">$</span>body_mass_g, <span class="st">"Adelie Penguin Body Mass"</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lnormal_qqplot</span>(cs_penguins<span class="sc">$</span>body_mass_g, <span class="st">"Chinstrap Penguin Body Mass"</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lnormal_qqplot</span>(g_penguins<span class="sc">$</span>body_mass_g, <span class="st">"Gentu Penguin Body Mass"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab2_Biometry_S25_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>female_penguins <span class="ot">&lt;-</span> <span class="fu">subset</span>(penguins, sex <span class="sc">==</span> <span class="st">"female"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>male_penguins <span class="ot">&lt;-</span> <span class="fu">subset</span>(penguins, sex <span class="sc">==</span> <span class="st">"male"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lnormal_qqplot</span>(female_penguins<span class="sc">$</span>body_mass_g, <span class="st">"Female Penguins Body Mass"</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lnormal_qqplot</span>(male_penguins<span class="sc">$</span>body_mass_g, <span class="st">"Male Penguins Body Mass"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab2_Biometry_S25_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>female_a_penguins <span class="ot">&lt;-</span> <span class="fu">subset</span>(a_penguins, sex <span class="sc">==</span> <span class="st">"female"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>male_a_penguins <span class="ot">&lt;-</span> <span class="fu">subset</span>(a_penguins, sex <span class="sc">==</span> <span class="st">"male"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>female_cs_penguins <span class="ot">&lt;-</span> <span class="fu">subset</span>(cs_penguins, sex <span class="sc">==</span> <span class="st">"female"</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>male_cs_penguins <span class="ot">&lt;-</span> <span class="fu">subset</span>(cs_penguins, sex <span class="sc">==</span> <span class="st">"male"</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>female_g_penguins <span class="ot">&lt;-</span> <span class="fu">subset</span>(g_penguins, sex <span class="sc">==</span> <span class="st">"female"</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>male_g_penguins <span class="ot">&lt;-</span> <span class="fu">subset</span>(g_penguins, sex <span class="sc">==</span> <span class="st">"male"</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lnormal_qqplot</span>(female_a_penguins<span class="sc">$</span>body_mass_g,<span class="st">"Female Adelie Penguins Body Mass"</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lnormal_qqplot</span>(male_a_penguins<span class="sc">$</span>body_mass_g,<span class="st">"Male Adelie Penguins Body Mass"</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lnormal_qqplot</span>(female_cs_penguins<span class="sc">$</span>body_mass_g, <span class="st">"Female Chinstrap Penguins Body Mass"</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lnormal_qqplot</span>(male_cs_penguins<span class="sc">$</span>body_mass_g,<span class="st">"Male Chinstrap Penguins Body Mass"</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lnormal_qqplot</span>(female_g_penguins<span class="sc">$</span>body_mass_g, <span class="st">"Female Gentu Penguins Body Mass"</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="fu">lnormal_qqplot</span>(male_g_penguins<span class="sc">$</span>body_mass_g, <span class="st">"Male Gentu Penguins Body Mass"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab2_Biometry_S25_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="list-of-all-problems-above-35-points" class="level2">
<h2 class="anchored" data-anchor-id="list-of-all-problems-above-35-points">5. List of All Problems (Above, 35 Points)</h2>
<ul>
<li><p>1.1(5 Points)</p></li>
<li><p>1.2 (5 Points)</p></li>
<li><p>2.1 (5 Points)</p></li>
<li><p>2.2 (10 Points)</p></li>
<li><p>3.1 (5 Points)</p></li>
<li><p>3.2 (5 Points)</p></li>
</ul>
</section>
<section id="acknowledgements" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgements">6. Acknowledgements</h2>
<p>Problem 1.2 adapted from problem sets shared by Dr.&nbsp;Philip L.F. Johnson. Problem 1.1 adapted from problem sets shared by Dr.&nbsp;Heather Lynch.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>